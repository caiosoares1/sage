{% extends 'base.html' %}

{% block title %}Vagas Disponíveis - Sistema de Gestão de Estágios{% endblock %}

{% block content %}
<div class="container">
    <div class="page-header">
        <h2><i class="fas fa-briefcase"></i> Vagas Disponíveis</h2>
        <p class="subtitle">Lista de vagas aprovadas e disponíveis para vínculo</p>
    </div>

    {% if messages %}
    <div class="messages">
        {% for message in messages %}
        <div class="alert alert-{{ message.tags }}">
            {{ message }}
        </div>
        {% endfor %}
    </div>
    {% endif %}

    <!-- Filtros -->
    <div class="card filtros-card">
        <div class="card-body">
            <form method="get" class="filtros-form">
                <div class="form-row">
                    <div class="form-group col-5">
                        <label for="empresa">Empresa</label>
                        <input type="text" name="empresa" id="empresa" class="form-control" 
                               value="{{ filtro_empresa }}" placeholder="Buscar por empresa...">
                    </div>
                    <div class="form-group col-4">
                        <label for="cargo">Cargo</label>
                        <input type="text" name="cargo" id="cargo" class="form-control" 
                               value="{{ filtro_cargo }}" placeholder="Buscar por cargo...">
                    </div>
                    <div class="form-group col-3 align-self-end">
                        <button type="submit" class="btn btn-secondary btn-block">
                            <i class="fas fa-search"></i> Filtrar
                        </button>
                    </div>
                </div>
            </form>
        </div>
    </div>

    <!-- Lista de Vagas -->
    <div class="card">
        <div class="card-body">
            {% if vagas %}
            <div class="vagas-grid">
                {% for vaga in vagas %}
                <div class="vaga-card">
                    <div class="vaga-header">
                        <h4>{{ vaga.titulo }}</h4>
                        <span class="badge badge-success">Disponível</span>
                    </div>
                    <div class="vaga-body">
                        <p><i class="fas fa-building"></i> <strong>{{ vaga.empresa.razao_social }}</strong></p>
                        <p><i class="fas fa-user-tie"></i> {{ vaga.cargo }}</p>
                        <p><i class="fas fa-clock"></i> {{ vaga.carga_horaria }}h/semana</p>
                        <p><i class="fas fa-calendar"></i> {{ vaga.data_inicio|date:"d/m/Y" }} a {{ vaga.data_fim|date:"d/m/Y" }}</p>
                        <p><i class="fas fa-user"></i> Supervisor: {{ vaga.supervisor.nome }}</p>
                    </div>
                    <div class="vaga-footer">
                        <a href="{% url 'detalhe_vaga' vaga.id %}" class="btn btn-info btn-sm">
                            <i class="fas fa-eye"></i> Ver Detalhes
                        </a>
                        <a href="{% url 'selecionar_aluno_vaga' vaga.id %}" class="btn btn-primary btn-sm">
                            <i class="fas fa-link"></i> Vincular Aluno
                        </a>
                    </div>
                </div>
                {% endfor %}
            </div>
            {% else %}
            <div class="empty-state">
                <i class="fas fa-briefcase fa-3x"></i>
                <h3>Nenhuma vaga disponível</h3>
                <p>Não há vagas aprovadas disponíveis para vínculo no momento.</p>
            </div>
            {% endif %}
        </div>
    </div>
</div>

<style>
.vagas-grid {
    display: grid;
    grid-template-columns: repeat(auto-fill, minmax(300px, 1fr));
    gap: 20px;
}

.vaga-card {
    background: #fff;
    border: 1px solid #e0e0e0;
    border-radius: 8px;
    overflow: hidden;
    transition: box-shadow 0.3s;
}

.vaga-card:hover {
    box-shadow: 0 4px 12px rgba(0,0,0,0.1);
}

.vaga-header {
    background: #4a6cf7;
    color: white;
    padding: 15px;
    display: flex;
    justify-content: space-between;
    align-items: center;
}

.vaga-header h4 {
    margin: 0;
    font-size: 1.1rem;
}

.vaga-body {
    padding: 15px;
}

.vaga-body p {
    margin: 8px 0;
    color: #555;
}

.vaga-body i {
    width: 20px;
    color: #4a6cf7;
}

.vaga-footer {
    padding: 15px;
    background: #f8f9fa;
    display: flex;
    gap: 10px;
    justify-content: flex-end;
}
</style>
{% endblock %}
